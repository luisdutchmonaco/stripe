define(["exports","metal/src/metal","./dom"],function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),a=function(){function e(){r(this,e)}return l(e,null,[{key:"run",value:function(e,n){var t=document.createElement("style");return t.innerHTML=e,n?n(t):document.head.appendChild(t),t}},{key:"runFile",value:function(n,t,r){var l=document.createElement("link");return l.rel="stylesheet",l.href=n,e.runStyle(l,t,r),l}},{key:"runStyle",value:function(e,r,l){var a=function(){r&&r()};return e.rel&&"stylesheet"!==e.rel&&"canonical"!==e.rel&&"alternate"!==e.rel?void n.async.nextTick(a):("STYLE"===e.tagName||"canonical"===e.rel||"alternate"===e.rel?n.async.nextTick(a):((0,t.once)(e,"load",a),(0,t.once)(e,"error",a)),l?l(e):document.head.appendChild(e),e)}},{key:"runStylesInElement",value:function(t,r,l){var a=t.querySelectorAll("style,link");if(0===a.length&&r)return void n.async.nextTick(r);for(var u=0,c=function(){r&&++u===a.length&&n.async.nextTick(r)},o=0;o<a.length;o++)e.runStyle(a[o],c,l)}}]),e}();e["default"]=a});