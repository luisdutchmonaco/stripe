define(["exports","metal/src/metal"],function(e,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(e){return{match:e[0],prefix:e[1],name:e[2],paramPattern:e[3],unnamedPattern:e[4],modifier:e[5]}}function a(e){for(var t="",r=0;r<e.length;r++)if(c["default"].isString(e[r]))t+=u(e[r]);else{var n=i(e[r].pattern);e[r].repeat&&(n+=i("\\/"+n)+"*"),n=u(e[r].prefix)+("("+n+")"),e[r].optional&&(e[r].partial||(n=i(n)),n+="?"),t+=n}return new RegExp("^"+f(t)+"$")}function i(e){return"(?:"+e+")"}function u(e){return e.replace(/([.+*?=^!:()[\]|\/\\])/g,"\\$1")}function f(e){return e+=/\/$/.test(e)?"?":"\\/?"}function o(e){if(!c["default"].isString(e))return e;for(var t=e,r=0,a=[],i="",u=0,f=s.exec(t);f;){var o=n(f);i=t.slice(u,f.index),u=f.index+o.match.length,a.push(i),a.push({name:o.name?o.name:""+r++,partial:t[u]&&t[u]!==o.prefix,prefix:o.prefix||"",pattern:o.paramPattern||o.unnamedPattern||"[^\\/]+",repeat:"*"===o.modifier||"+"===o.modifier,optional:"*"===o.modifier||"?"===o.modifier}),f=s.exec(t)}return u<t.length&&a.push(t.substr(u)),a}function p(e){return a(o(e))}function l(e,t){var r={},n=o(e),i=t.match(a(n));if(!i)return null;for(var u=1,f=0;f<n.length;f++)if(!c["default"].isString(n[f])){var p=i[u++];c["default"].isDef(p)&&(n[f].repeat&&(p=p.split("/")),r[n[f].name]=p)}return r}Object.defineProperty(e,"__esModule",{value:!0}),e.parse=o,e.toRegex=p,e.extractData=l;var c=r(t),s=/([\/])?(?:(?:\:(\w+)(?:\(((?:\\.|[^\\()])*)\))?|\(((?:\\.|[^\\()])+)\))([+*?])?)/g});