define(["exports","metal/src/metal","./domData","./DomDelegatedEventHandle","./DomEventHandle"],function(e,t,n,r,i){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,n){if((0,t.isObject)(e)&&(0,t.isString)(n)){e.length||(e=[e]);for(var r=0;r<e.length;r++)"classList"in e[r]?s(e[r],n):l(e[r],n)}}function s(e,t){t.split(" ").forEach(function(t){t&&e.classList.add(t)})}function l(e,t){var n=" "+e.className+" ",r="";t=t.split(" ");for(var i=0;i<t.length;i++){var o=t[i];n.indexOf(" "+o+" ")===-1&&(r+=" "+o)}r&&(e.className=e.className+r)}function c(e,t,n){f(ee["default"].get(e,"listeners",{}),t,n)}function u(e,t,n,r){var i=ee["default"].get(e,"delegating",{});f(i[t].selectors,n,r)}function f(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function d(e,t){var n=ee["default"].get(e,"delegating",{});n[t]||(n[t]={handle:P(e,t,C,!!se[t]),selectors:{}})}function p(e,t){for(;e&&!O(e,t);)e=e.parentNode;return e}function g(e,n){if((0,t.isString)(n)&&(n=m(n)),N(n))for(var r=Array.prototype.slice.call(n),i=0;i<r.length;i++)e.appendChild(r[i]);else e.appendChild(n);return n}function m(e){var t=document.createElement("div");t.innerHTML="<br>"+e,t.removeChild(t.firstChild);for(var n=document.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);return n}function v(e,n){return(0,t.isDocument)(e)?e.documentElement.contains(n):e.contains(n)}function h(e,n,r,i,o){var a=oe[n];return a&&a.delegate&&(n=a.originalEvent,i=a.handler.bind(a,i)),o&&(i=i.bind(),i.defaultListener_=!0),d(e,n),(0,t.isString)(r)?u(e,n,r,i):c(r,n,i),new te["default"]((0,t.isString)(r)?e:r,n,i,(0,t.isString)(r)?r:null)}function E(e,t,n){if(n&&"click"===t&&2===n.button)return!1;var r=["BUTTON","INPUT","SELECT","TEXTAREA","FIELDSET"];return!("click"===t&&r.indexOf(e.tagName)>-1)||!(e.disabled||I(e,"fieldset[disabled]"))}function N(e){return(0,t.isDefAndNotNull)(e)&&"number"==typeof e.length&&"function"==typeof e.item}function b(e){e&&g(document.body,e)}function y(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function C(e){M(e);var t=!0,n=e.currentTarget,r=[];return t&=G(n,e,r),t&=X(r,e),e.delegateTarget=null,e[ae]=n,t}function S(e,t){return"classList"in e?L(e,t):D(e,t)}function L(e,t){return t.indexOf(" ")===-1&&e.classList.contains(t)}function D(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>=0&&1===t.split(" ").length}function T(e){return 0===e.childNodes.length}function O(e,t){if(!e||1!==e.nodeType)return!1;var n=Element.prototype,r=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return r?r.call(e,t):_(e,t)}function _(e,t){var n=e.parentNode;if(n)for(var r=n.querySelectorAll(t),i=0;i<r.length;++i)if(r[i]===e)return!0;return!1}function x(e,t){do if(e=e.nextSibling,e&&O(e,t))return e;while(e);return null}function M(e){e.stopPropagation=z,e.stopImmediatePropagation=U}function P(e,n,r,i){if((0,t.isString)(e))return h(document,n,e,r);var o=oe[n];return o&&o.event&&(n=o.originalEvent,r=o.handler.bind(o,r)),e.addEventListener(n,r,i),new ne["default"](e,n,r,i)}function A(e,t,n){var r=P(e,t,function(){return r.removeListener(),n.apply(this,arguments)});return r}function I(e,t){return p(e.parentNode,t)}function j(e,n){if((0,t.isString)(n)&&(n=m(n)),!N(n)&&!(0,t.isDefAndNotNull)(e.firstChild))return g(e,n);if(N(n))for(var r=Array.prototype.slice.call(n),i=r.length-1;i>=0;i--)e.insertBefore(r[i],e.firstChild);else e.insertBefore(n,e.firstChild);return n}function k(e,t){oe[e]=t}function w(e){for(var t=void 0;t=e.firstChild;)e.removeChild(t)}function F(e,n){if((0,t.isObject)(e)&&(0,t.isString)(n)){e.length||(e=[e]);for(var r=0;r<e.length;r++)"classList"in e[r]?H(e[r],n):B(e[r],n)}}function H(e,t){t.split(" ").forEach(function(t){t&&e.classList.remove(t)})}function B(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++)n=n.replace(" "+t[r]+" "," ");e.className=n.trim()}function q(e,t){e&&t&&e!==t&&e.parentNode&&e.parentNode.replaceChild(t,e)}function U(){var e=this;e.stopped=!0,e.stoppedImmediate=!0,Event.prototype.stopImmediatePropagation.call(e)}function z(){var e=this;e.stopped=!0,Event.prototype.stopPropagation.call(e)}function R(e,n){if(oe[n])return!0;(0,t.isString)(e)&&(re[e]||(re[e]=document.createElement(e)),e=re[e]);var r=e.tagName;return ie[r]&&ie[r].hasOwnProperty(n)||(ie[r]=ie[r]||{},ie[r][n]="on"+n in e),ie[r][n]}function X(e,t){for(var n=!0,r=0;r<e.length&&!t.defaultPrevented;r++)t.delegateTarget=e[r].element,n&=e[r].fn(t);return n}function G(e,t,n){for(var r=!0,i=t.target,o=e.parentNode;i&&i!==o&&!t.stopped;)E(i,t.type,t)&&(t.delegateTarget=i,r&=W(i,t,n),r&=$(e,i,t,n)),i=i.parentNode;return r}function J(e){return(0,t.isElement)(e)||(0,t.isDocument)(e)||(0,t.isDocumentFragment)(e)?e:(0,t.isString)(e)?document.querySelector(e):null}function K(e,n){(0,t.isObject)(e)&&(0,t.isString)(n)&&("classList"in e?Q(e,n):V(e,n))}function Q(e,t){t.split(" ").forEach(function(t){e.classList.toggle(t)})}function V(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++){var i=" "+t[r]+" ",o=n.indexOf(i);if(o===-1)n=""+n+t[r]+" ";else{var a=n.substring(0,o),s=n.substring(o+i.length);n=a+" "+s}}e.className=n.trim()}function W(e,n,r){var i=n[ae];if(!(0,t.isDef)(i)||!v(i,e)){var o=ee["default"].get(e,"listeners",{})[n.type];return Z(o,n,e,r)}return!0}function Y(e,n,r){if(E(e,n,r)){var i=document.createEvent("HTMLEvents");i.initEvent(n,!0,!0),t.object.mixin(i,r),e.dispatchEvent(i)}}function Z(e,t,n,r){var i=!0;e=e||[];for(var o=0;o<e.length&&!t.stoppedImmediate;o++)e[o].defaultListener_?r.push({element:n,fn:e[o]}):i&=e[o](t);return i}function $(e,t,n,r){for(var i=!0,o=ee["default"].get(e,"delegating",{}),a=o[n.type].selectors,s=Object.keys(a),l=0;l<s.length&&!n.stoppedImmediate;l++)if(O(t,s[l])){var c=a[s[l]];i&=Z(c,n,t,r)}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.customEvents=void 0,e.addClasses=a,e.closest=p,e.append=g,e.buildFragment=m,e.contains=v,e.delegate=h,e.isNodeListLike=N,e.enterDocument=b,e.exitDocument=y,e.hasClass=S,e.isEmpty=T,e.match=O,e.next=x,e.on=P,e.once=A,e.parent=I,e.prepend=j,e.registerCustomEvent=k,e.removeChildren=w,e.removeClasses=F,e.replace=q,e.supportsEvent=R,e.toElement=J,e.toggleClasses=K,e.triggerEvent=Y;var ee=o(n),te=o(r),ne=o(i),re={},ie={},oe=e.customEvents={},ae="__metal_last_container__",se={blur:!0,error:!0,focus:!0,invalid:!0,load:!0,scroll:!0}});